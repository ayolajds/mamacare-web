<div class="sesiones-container">
  <!-- Header -->
  <div class="header">
    <h1 class="page-title">
      <i class="icon-pregnancy"></i>
      Sesiones Individuales
    </h1>
    <button class="btn btn-primary" (click)="openNewSessionModal()">
      <i class="icon-plus"></i>
      Nueva Sesión
    </button>
  </div>

  <!-- Estadísticas -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">
        <i class="icon-calendar"></i>
      </div>
      <div class="stat-info">
        <h3>Programadas</h3>
        <span class="stat-number">{{ stats.scheduled }}</span>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">
        <i class="icon-check"></i>
      </div>
      <div class="stat-info">
        <h3>Completadas</h3>
        <span class="stat-number">{{ stats.completed }}</span>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">
        <i class="icon-clock"></i>
      </div>
      <div class="stat-info">
        <h3>En Progreso</h3>
        <span class="stat-number">{{ stats.inProgress }}</span>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">
        <i class="icon-alert"></i>
      </div>
      <div class="stat-info">
        <h3>Próximas 24h</h3>
        <span class="stat-number">{{ stats.next24h }}</span>
      </div>
    </div>
  </div>

  <!-- Filtros y Búsqueda -->
  <div class="filters-section">
    <div class="search-box">
      <input 
        type="text" 
        placeholder="Buscar sesión..." 
        [(ngModel)]="searchTerm"
        (input)="filterSessions()"
        class="search-input"
      >
      <i class="icon-search"></i>
    </div>
    
    <div class="filter-options">
      <select [(ngModel)]="statusFilter" (change)="filterSessions()" class="filter-select">
        <option value="">Todos los estados</option>
        <option value="programada">Programada</option>
        <option value="en-progreso">En Progreso</option>
        <option value="completada">Completada</option>
        <option value="cancelada">Cancelada</option>
      </select>
      
      <select [(ngModel)]="typeFilter" (change)="filterSessions()" class="filter-select">
        <option value="">Todos los tipos</option>
        <option value="prenatal">Prenatal</option>
        <option value="postnatal">Postnatal</option>
        <option value="lactancia">Lactancia</option>
        <option value="cuidado-bebe">Cuidado del Bebé</option>
      </select>
    </div>
  </div>

  <!-- Lista de Sesiones -->
  <div class="sessions-list">
    <div class="session-card" *ngFor="let session of filteredSessions" [class.urgent]="isUrgent(session.fecha)">
      <div class="session-header">
        <div class="session-info">
          <h4 class="session-title">{{ session.pacienteNombre }}</h4>
          <span class="session-type {{ session.tipo }}">{{ getTypeLabel(session.tipo) }}</span>
        </div>
        <div class="session-status">
          <span class="status-badge {{ session.estado }}">{{ getStatusLabel(session.estado) }}</span>
          <span class="session-date">{{ formatDate(session.fecha) }}</span>
        </div>
      </div>
      
      <div class="session-details">
        <div class="detail-item">
          <i class="icon-clock"></i>
          <span>{{ session.duracion }} minutos</span>
        </div>
        <div class="detail-item">
          <i class="icon-user"></i>
          <span>Especialista: {{ session.especialista }}</span>
        </div>
        <div class="detail-item" *ngIf="session.notas">
          <i class="icon-note"></i>
          <span class="session-notes">{{ session.notas }}</span>
        </div>
      </div>
      
      <div class="session-actions">
        <button 
          class="btn btn-outline" 
          (click)="viewSessionDetails(session)"
          *ngIf="session.estado !== 'cancelada'"
        >
          <i class="icon-eye"></i>
          Ver
        </button>
        <button 
          class="btn btn-warning" 
          (click)="editSession(session)"
          *ngIf="session.estado === 'programada'"
        >
          <i class="icon-edit"></i>
          Editar
        </button>
        <button 
          class="btn btn-success" 
          (click)="startSession(session)"
          *ngIf="session.estado === 'programada'"
        >
          <i class="icon-play"></i>
          Iniciar
        </button>
        <button 
          class="btn btn-danger" 
          (click)="cancelSession(session)"
          *ngIf="session.estado === 'programada' || session.estado === 'en-progreso'"
        >
          <i class="icon-cancel"></i>
          Cancelar
        </button>
        <button 
          class="btn btn-primary" 
          (click)="completeSession(session)"
          *ngIf="session.estado === 'en-progreso'"
        >
          <i class="icon-check"></i>
          Completar
        </button>
      </div>
    </div>
  </div>

  <!-- Modal Nueva Sesión -->
  <div class="modal" [class.active]="showModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>{{ editingSession ? 'Editar Sesión' : 'Nueva Sesión' }}</h2>
        <button class="close-btn" (click)="closeModal()">&times;</button>
      </div>
      
      <form [formGroup]="sessionForm" (ngSubmit)="saveSession()" class="session-form">
        <div class="form-row">
          <div class="form-group">
            <label for="paciente">Paciente *</label>
            <select id="paciente" formControlName="pacienteId" class="form-control">
              <option value="">Seleccionar paciente</option>
              <option *ngFor="let paciente of pacientes" [value]="paciente.id">
                {{ paciente.nombre }} - {{ paciente.semanaGestacion }} semanas
              </option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="tipo">Tipo de Sesión *</label>
            <select id="tipo" formControlName="tipo" class="form-control">
              <option value="prenatal">Prenatal</option>
              <option value="postnatal">Postnatal</option>
              <option value="lactancia">Lactancia</option>
              <option value="cuidado-bebe">Cuidado del Bebé</option>
            </select>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="fecha">Fecha *</label>
            <input type="datetime-local" id="fecha" formControlName="fecha" class="form-control">
          </div>
          
          <div class="form-group">
            <label for="duracion">Duración (minutos) *</label>
            <input type="number" id="duracion" formControlName="duracion" class="form-control" min="15" max="120">
          </div>
        </div>
        
        <div class="form-group">
          <label for="especialista">Especialista *</label>
          <select id="especialista" formControlName="especialista" class="form-control">
            <option value="dr-garcia">Dra. María García</option>
            <option value="dr-rodriguez">Dr. Carlos Rodríguez</option>
            <option value="en-fernández">Enf. Laura Fernández</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="notas">Notas Adicionales</label>
          <textarea 
            id="notas" 
            formControlName="notas" 
            class="form-control" 
            rows="3"
            placeholder="Observaciones, síntomas, preguntas específicas..."
          ></textarea>
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn btn-outline" (click)="closeModal()">Cancelar</button>
          <button type="submit" class="btn btn-primary" [disabled]="!sessionForm.valid">
            {{ editingSession ? 'Actualizar' : 'Crear' }} Sesión
          </button>
        </div>
      </form>
    </div>
  </div>
</div> 