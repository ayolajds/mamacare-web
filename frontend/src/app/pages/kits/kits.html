<div class="kits-container">
  <!-- Header Section -->
  <div class="kits-header">
    <h1 class="kits-title">Memorias que permanecen</h1>
    <p class="kits-subtitle">Cada kit está diseñado para conservar tus recuerdos más preciados</p>
    
    <!-- Filtros -->
    <div class="kits-filters">
      <button 
        class="filter-btn" 
        [class.active]="activeFilter === 'all'"
        (click)="filterKits('all')">
        Todos
      </button>
      <button 
        class="filter-btn" 
        [class.active]="activeFilter === 'basico'"
        (click)="filterKits('basico')">
        Kit Básico
      </button>
      <button 
        class="filter-btn" 
        [class.active]="activeFilter === 'intermedio'"
        (click)="filterKits('intermedio')">
        Kit Intermedio
      </button>
      <button 
        class="filter-btn" 
        [class.active]="activeFilter === 'integral'"
        (click)="filterKits('integral')">
        Kit Integral
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Cargando kits...</p>
  </div>

  <!-- Kits Grid -->
  <div class="kits-grid" *ngIf="!isLoading && filteredKits.length > 0">
    <div class="kit-card" *ngFor="let kit of filteredKits">
      
      <!-- ✅ CORREGIDO: Mostrar imagen real en lugar de icono -->
      <div class="kit-image">
        <img [src]="kit.imagen" [alt]="kit.nombre" class="kit-img">
        <!-- Badge si ya tiene el kit -->
        <div class="kit-badge" *ngIf="yaTieneKit(kit.id)">
          <i data-lucide="check" class="badge-icon"></i>
          En tu colección
        </div>
      </div>

      <!-- Contenido -->
      <div class="kit-content">
        <div class="kit-category">{{ getCategoryName(kit.categoria) }}</div>
        <h3 class="kit-name">{{ kit.nombre }}</h3>
        <p class="kit-description">{{ kit.descripcion }}</p>

        <!-- Elementos incluidos -->
        <div class="kit-elements">
          <h4>
            <i data-lucide="package" class="section-icon"></i>
            Contenido del kit:
          </h4>
          <ul class="kit-features">
            <li *ngFor="let element of kit.elementos">{{ element }}</li>
          </ul>
        </div>

        <!-- Precio -->
        <div class="kit-price">
          <span class="current-price">${{ formatPrice(kit.precio) }} COP</span>
        </div>

        <!-- Acciones -->
        <div class="kit-actions">
          <button 
            class="btn-primary"
            (click)="solicitarKit(kit)">
            <span *ngIf="yaTieneKit(kit.id)">✅ Comprar otro</span>
            <span *ngIf="!yaTieneKit(kit.id)">Comprar Kit</span>
          </button>
          
          <button class="btn-secondary" (click)="showKitDetails(kit)">
            Ver Detalles
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading && filteredKits.length === 0">
    <div class="empty-icon">
      <i data-lucide="package"></i>
    </div>
    <h3>No se encontraron kits</h3>
    <p>Intenta con otros filtros</p>
  </div>
</div>

<!-- Modal de Detalles del Kit -->
<div class="kit-modal" [class.hidden]="!selectedKit">
  <div class="modal-content" *ngIf="selectedKit">
    <button class="modal-close" (click)="closeModal()">
      <i data-lucide="x"></i>
    </button>
    <div class="modal-body">
      <h2>{{ selectedKit.nombre }}</h2>
      <p class="modal-category">{{ getCategoryName(selectedKit.categoria) }}</p>
      
      <!-- ✅ CORREGIDO: Mostrar imagen real en modal -->
      <div class="modal-image">
        <img [src]="selectedKit.imagen" [alt]="selectedKit.nombre" class="modal-img">
      </div>

      <p class="modal-description">{{ selectedKit.descripcion }}</p>

      <div class="modal-section">
        <h4>
          <i data-lucide="package" class="section-icon"></i>
          Contenido del kit:
        </h4>
        <ul class="modal-features">
          <li *ngFor="let element of selectedKit.elementos">{{ element }}</li>
        </ul>
      </div>

      <!-- Precio Modal -->
      <div class="modal-price">
        <span class="current-price">${{ formatPrice(selectedKit.precio) }} COP</span>
      </div>

      <!-- Botón del Modal -->
      <button 
        class="btn-primary modal-add-btn"
        (click)="solicitarKit(selectedKit)">
        <span *ngIf="yaTieneKit(selectedKit.id)">✅ Comprar otro</span>
        <span *ngIf="!yaTieneKit(selectedKit.id)">Solicitar este Kit</span>
      </button>
    </div>
  </div>
</div>