<div class="register-wrapper">
  <div class="register-container card">
    <img src="/imagenes/register1.jpg" alt="Registro Ma´Care" class="register-image">
    <h2 class="card-title">Crear Cuenta</h2>

    <form (ngSubmit)="onSubmit(registerForm)" #registerForm="ngForm">
      <!-- Name and Last Name -->
      <div class="name-group">
        <div class="form-group">
          <input
            type="text"
            [(ngModel)]="name"
            name="name"                  
            class="form-control"
            placeholder="Nombre"
            (keypress)="onNameKeyPress($event)"
            (input)="onNameInput($event, 'name')"
            required
            #nameInput="ngModel" />
          <small *ngIf="nameInput.invalid && nameInput.touched" class="error-text">
            Solo letras, mínimo 2 caracteres
          </small>
        </div>

        <div class="form-group">
          <input
            type="text"
            [(ngModel)]="lastName"       
            name="lastName"              
            class="form-control"
            placeholder="Apellido"
            (keypress)="onNameKeyPress($event)"
            (input)="onNameInput($event, 'lastName')"
            required
            #lastNameInput="ngModel" />
          <small *ngIf="lastNameInput.invalid && lastNameInput.touched" class="error-text">
            Solo letras, mínimo 2 caracteres
          </small>
        </div>
      </div>

      <!-- Email -->
      <div class="form-group">
        <input
          type="email"
          [(ngModel)]="email"
          name="email"
          class="form-control"
          placeholder="Correo electrónico"
          required
          #emailInput="ngModel" />
        <small *ngIf="emailInput.invalid && emailInput.touched" class="error-text">
          Ingresa un email válido
        </small>
      </div>

      <!-- Password -->
      <div class="form-group password-group">
        <input
          [type]="showPassword ? 'text' : 'password'"
          [(ngModel)]="password"
          name="password"
          class="form-control password-input"
          placeholder="Contraseña (mínimo 8 caracteres)"
          required
          minlength="8"
          #passwordInput="ngModel" />
        <button type="button" class="toggle-password" (click)="showPassword = !showPassword">
          <svg class="icon-eye" [class.hidden]="showPassword" viewBox="0 0 24 24">
            <path d="M12 9a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5a5 5 0 0 1 5-5a5 5 0 0 1 5 5a5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5z"/>
          </svg>
          <svg class="icon-eye-slash" [class.hidden]="!showPassword" viewBox="0 0 24 24">
            <path d="M11.83 9L15 12.16C15 12.11 15 12.05 15 12c0-1.66-1.34-3-3-3c-.05 0-.11 0-.16 0l1.51 1.51c.06-.01.11-.01.16-.01c.83 0 1.5.67 1.5 1.5c0 .05 0 .11-.01.16l1.51 1.51c.05-.15.08-.31.08-.47c0-2.76-2.24-5-5-5c-.16 0-.32.03-.47.08L9.83 7h2.67zM2.81 2.81L1.39 4.22l3.24 3.24C3.83 8.69 3 10.75 3 12c0 2.21 1.79 4 4 4c1.25 0 2.31-.83 2.69-2.03l2.12 2.12C10.84 16.8 9.45 18 7 18c-3.31 0-6-2.69-6-6c0-1.45.55-2.76 1.44-3.76l-1.45-1.45l1.41-1.41l17 17l-1.41 1.41l-4.28-4.28L13 15.66c-.37.04-.75.07-1.14.07c-3.31 0-6-2.69-6-6c0-.39.03-.77.07-1.14L2.81 2.81zM7 10c0-.55.45-1 1-1c.17 0 .33.05.46.12l-1.34 1.34c-.07-.13-.12-.29-.12-.46zm9.72 5.57l-1.67-1.67c.13.04.27.07.42.07c.83 0 1.5-.67 1.5-1.5c0-.15-.03-.29-.07-.42l1.67 1.67c.05.15.08.31.08.47c0 2.76-2.24 5-5 5c-.16 0-.32-.03-.47-.08z"/>
          </svg>
        </button>
        <small *ngIf="passwordInput.invalid && passwordInput.touched" class="error-text">
          La contraseña debe tener al menos 8 caracteres
        </small>
        <small *ngIf="password && !isPasswordValid()" class="error-text">
          ❌ Mínimo 8 caracteres
        </small>
        <small *ngIf="password && isPasswordValid()" class="success-text">
          ✅ Contraseña válida
        </small>
      </div>

      <!-- Confirm Password -->
      <div class="form-group password-group">
        <input
          [type]="showConfirmPassword ? 'text' : 'password'"
          [(ngModel)]="confirmPassword"
          name="confirmPassword"
          class="form-control password-input"
          placeholder="Confirmar contraseña"
          required
          #confirmPasswordInput="ngModel" />
        <button type="button" class="toggle-password" (click)="showConfirmPassword = !showConfirmPassword">
          <svg class="icon-eye" [class.hidden]="showConfirmPassword" viewBox="0 0 24 24">
            <path d="M12 9a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5a5 5 0 0 1 5-5a5 5 0 0 1 5 5a5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5z"/>
          </svg>
          <svg class="icon-eye-slash" [class.hidden]="!showConfirmPassword" viewBox="0 0 24 24">
            <path d="M11.83 9L15 12.16C15 12.11 15 12.05 15 12c0-1.66-1.34-3-3-3c-.05 0-.11 0-.16 0l1.51 1.51c.06-.01.11-.01.16-.01c.83 0 1.5.67 1.5 1.5c0 .05 0 .11-.01.16l1.51 1.51c.05-.15.08-.31.08-.47c0-2.76-2.24-5-5-5c-.16 0-.32.03-.47.08L9.83 7h2.67zM2.81 2.81L1.39 4.22l3.24 3.24C3.83 8.69 3 10.75 3 12c0 2.21 1.79 4 4 4c1.25 0 2.31-.83 2.69-2.03l2.12 2.12C10.84 16.8 9.45 18 7 18c-3.31 0-6-2.69-6-6c0-1.45.55-2.76 1.44-3.76l-1.45-1.45l1.41-1.41l17 17l-1.41 1.41l-4.28-4.28L13 15.66c-.37.04-.75.07-1.14.07c-3.31 0-6-2.69-6-6c0-.39.03-.77.07-1.14L2.81 2.81zM7 10c0-.55.45-1 1-1c.17 0 .33.05.46.12l-1.34 1.34c-.07-.13-.12-.29-.12-.46zm9.72 5.57l-1.67-1.67c.13.04.27.07.42.07c.83 0 1.5-.67 1.5-1.5c0-.15-.03-.29-.07-.42l1.67 1.67c.05.15.08.31.08.47c0 2.76-2.24 5-5 5c-.16 0-.32-.03-.47-.08z"/>
          </svg>
        </button>
        <small *ngIf="confirmPasswordInput.invalid && confirmPasswordInput.touched" class="error-text">
          Confirma tu contraseña
        </small>
        <small *ngIf="confirmPassword && password !== confirmPassword" class="error-text">
          ❌ Las contraseñas no coinciden
        </small>
        <small *ngIf="confirmPassword && password === confirmPassword && isPasswordValid()" class="success-text">
          ✅ Contraseñas coinciden
        </small>
      </div>

      <!-- Birth Date and Phone -->
      <div class="contact-group">
        <div class="form-group">
          <label class="form-label">Fecha de Nacimiento</label>
          <input
            type="date"
            [(ngModel)]="birthDate"          
            name="birthDate"                 
            class="form-control"
            [min]="minDate"
            [max]="maxDate"
            required
            #birthDateInput="ngModel" />
          <small *ngIf="birthDateInput.invalid && birthDateInput.touched" class="error-text">
            Fecha requerida (18+ años)
          </small>
        </div>

        <div class="form-group">
          <label class="form-label">Teléfono (10 dígitos)</label>
          <input
            type="tel"
            [(ngModel)]="phone"  
            name="phone"                     
            class="form-control"
            placeholder="Ej: 3001234567"
            (keypress)="onPhoneKeyPress($event)"
            (input)="onPhoneInput($event)"
            maxlength="10"
            required
            #phoneInput="ngModel" />
          <small *ngIf="phoneInput.invalid && phoneInput.touched" class="error-text">
            10 números requeridos
          </small>
          <small class="info-text" *ngIf="phone">
            Caracteres: {{phone.length}}/10
          </small>
        </div>
      </div>

      <!-- Botones -->
      <div class="button-group">
        <button
          type="submit"
          class="btn-register"
          [disabled]="loading || registerForm.invalid">
          <span *ngIf="loading" class="loading-spinner"></span>
          {{ loading ? 'Creando Cuenta...' : 'Registrarme' }}
        </button>

        <button
          type="button"
          class="btn-login"
          (click)="navigateToLogin()">
          ¿Ya tienes cuenta? Inicia Sesión
        </button>
      </div>
    </form>
  </div>
</div>